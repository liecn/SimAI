(py39) lichenni@tardy:~/projects/SimAI$ time AS_SEND_LAT=3 AS_NVLS_ENABLE=1 ./bin/SimAI_flowsim -t 8 -w ./example/microAllReduce_16gpus.txt -n ./Spectrum-X_128g_8gps_100Gbps_A100
[FLOWSIM] Starting SimAI-FlowSim
[FLOWSIM] Workload: ./example/microAllReduce_16gpus.txt
[FLOWSIM] Network: ./Spectrum-X_128g_8gps_100Gbps_A100
[CUSTOM ROUTING] Custom routing enabled via command line argument
[SYSTEM ROUTING] Routing framework initialized with topology: ./Spectrum-X_128g_8gps_100Gbps_A100
[SYSTEM ROUTING] Topology has 216 nodes
[ROUTING] Synced 59392 pre-calculated flow paths with backend using routing framework
[FLOWSIM] Topology: 128 GPUs, 16 NVSwitches, 72 switches (A100)
The final active chunks per dimension 1 after allocating to queues is: 1
ring of node 0, id: 0 dimension: local total nodes in ring: 144 index in ring: 0 offset: 1total nodes in ring: 144
ring of node 0, id: 0 dimension: local total nodes in ring: 144 index in ring: 0 offset: 1total nodes in ring: 144
ring of node 0, id: 0 dimension: local total nodes in ring: 144 index in ring: 0 offset: 1total nodes in ring: 144
ring of node 0, id: 0 dimension: local total nodes in ring: 144 index in ring: 0 offset: 1total nodes in ring: 144
total nodes: 144
Success in opening workload file
model_parallel_NPU_group is 16
checkpoints layers are: 
layers initiating fwd_in_bckwd are: 
ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0 offset: 1total nodes in ring: 16
ring of node 0, id: 0 dimension: local total nodes in ring: 9 index in ring: 0 offset: 16total nodes in ring: 9
ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0 offset: 1total nodes in ring: 16
ring of node 0, id: 0 dimension: local total nodes in ring: 9 index in ring: 0 offset: 16total nodes in ring: 9
ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0 offset: 1total nodes in ring: 16
ring of node 0, id: 0 dimension: local total nodes in ring: 9 index in ring: 0 offset: 16total nodes in ring: 9
ring of node 0, id: 0 dimension: local total nodes in ring: 16 index in ring: 0 offset: 1total nodes in ring: 16
ring of node 0, id: 0 dimension: local total nodes in ring: 9 index in ring: 0 offset: 16total nodes in ring: 9
pp_commize:0
id: embedding_layer , depen: -1 , wg_comp_time: 1
id: embedding_layer , depen: -1 , wg_comp_time: 1
type: HYBRID_TRANSFORMER_FWD_IN_BCKWD ,num passes: 1 ,lines: 2 compute scale: 1 ,comm scale: 1
stat path: ./simai_flowsim_ ,total rows: 1 ,stat row: 0
CSV path and filename: ./simai_flowsim_EndToEnd.csv
chunk size is: 16777216 , size is: 16777216 , layer_num is: 0 , node: 0
info: all-reduce forward pass collective issued for layer: embedding_layer, involved dimensions:  1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
[FLOWSIM] SEND #1 at time=556010ns: src=0 -> dst=1, size=131072, tag=0
[FLOWSIM] SEND #2 at time=556010ns: src=0 -> dst=9, size=131072, tag=30
[FLOWSIM] SEND #3 at time=556010ns: src=0 -> dst=1, size=131072, tag=60
[FLOWSIM] SEND #4 at time=556010ns: src=0 -> dst=1, size=131072, tag=90
[FLOWSIM] SEND #5 at time=556010ns: src=0 -> dst=1, size=131072, tag=120
[FLOWSIM] SEND #10000 at time=556100ns: src=97 -> dst=98, size=131072, tag=9
[FLOWSIM] SEND #20000 at time=556200ns: src=76 -> dst=77, size=131072, tag=19
[FLOWSIM] SEND #30000 at time=556300ns: src=39 -> dst=40, size=131072, tag=29
[FLOWSIM] CALLBACK #1 at time=651810ns: src=0 -> dst=1, size=131072, tag=0
[FLOWSIM] CALLBACK #2 at time=651810ns: src=0 -> dst=1, size=131072, tag=60
[FLOWSIM] CALLBACK #3 at time=651810ns: src=0 -> dst=1, size=131072, tag=90
[FLOWSIM] CALLBACK #4 at time=651810ns: src=0 -> dst=1, size=131072, tag=120
[FLOWSIM] CALLBACK #5 at time=651810ns: src=0 -> dst=1, size=131072, tag=150
[FLOWSIM] CALLBACK #10000 at time=651810ns: src=29 -> dst=30, size=131072, tag=71
[FLOWSIM] CALLBACK #20000 at time=651810ns: src=34 -> dst=35, size=131072, tag=82
[FLOWSIM] CALLBACK #30000 at time=1.82031e+06ns: src=39 -> dst=40, size=131072, tag=24
***** info: fwd pass comm collective for layer: embedding_layer is finished************
chunk size is: 67108864 , size is: 67108864 , layer_num is: 1 , node: 0
info: all-reduce forward pass collective issued for layer: embedding_layer, involved dimensions:  1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
[FLOWSIM] SEND #40000 at time=2.37641e+06ns: src=1 -> dst=2, size=524288, tag=489
[FLOWSIM] SEND #50000 at time=2.3765e+06ns: src=107 -> dst=108, size=524288, tag=498
[FLOWSIM] SEND #60000 at time=2.3766e+06ns: src=70 -> dst=71, size=524288, tag=508
[FLOWSIM] CALLBACK #40000 at time=2.74737e+06ns: src=37 -> dst=38, size=524288, tag=520
[FLOWSIM] CALLBACK #50000 at time=2.74737e+06ns: src=67 -> dst=68, size=524288, tag=711
[FLOWSIM] CALLBACK #60000 at time=7.41549e+06ns: src=94 -> dst=87, size=524288, tag=708
***** info: fwd pass comm collective for layer: embedding_layer is finished************
info: no input grad collective for layer: embedding_layer
info: no weight grad collective for layer: embedding_layer
info: no input grad collective for layer: embedding_layer
info: no weight grad collective for layer: embedding_layer
pass: 0 finished at time: 7415498
workload stats for the job scheduled at NPU offset: 0
*******************
Layer id: embedding_layer
Total collectives issued for this layer: 1
*************************  Workload stats  ************************* embedding_layer
id: embedding_layer ,Total cycles spent on fwd pass compute: 556000
id: embedding_layer ,Total cycles spent on weight grad compute: 1
id: embedding_layer ,Total cycles spent on input grad compute: 1
id: embedding_layer ,Total cycles spent idle waiting for fwd finish: 1264308
id: embedding_layer ,Total cycles spent idle waiting for weight grad finish: 0
id: embedding_layer ,Total cycles spent idle waiting for input grad finish: 0
id: embedding_layer ,Total cycles spent on fwd pass comm: 1264308
id: embedding_layer ,Total cycles spent on weight grad comm: 0
id: embedding_layer ,Total cycles spent on input grad comm: 0
*******************
Layer id: embedding_layer
Total collectives issued for this layer: 1
*************************  Workload stats  ************************* embedding_layer
id: embedding_layer ,Total cycles spent on fwd pass compute: 556000
id: embedding_layer ,Total cycles spent on weight grad compute: 1
id: embedding_layer ,Total cycles spent on input grad compute: 1
id: embedding_layer ,Total cycles spent idle waiting for fwd finish: 5039181
id: embedding_layer ,Total cycles spent idle waiting for weight grad finish: 0
id: embedding_layer ,Total cycles spent idle waiting for input grad finish: 0
id: embedding_layer ,Total cycles spent on fwd pass comm: 5039181
id: embedding_layer ,Total cycles spent on weight grad comm: 0
id: embedding_layer ,Total cycles spent on input grad comm: 0
*************************
all passes finished at time: 7415499, id of first layer: embedding_layer
*****
Time to exit: Tue Aug  5 22:04:13 2025
all-reduce Collective implementation: NcclFlowModel
reduce-scatter Collective implementation: NcclFlowModel
all-gather Collective implementation: NcclFlowModel
all-to-all Collective implementation: NcclFlowModel
Collective optimization: baseline
Total sim duration: 0:0 hours
Total streams injected: 2
Total streams finished: 2
Percentage of finished streams: 100 %
*****
[FLOWSIM] Simulation completed successfully
All data sent from node 0 is 157286400
All data received by node 0 is 157286400
All data sent from node 1 is 157286400
All data received by node 1 is 157286400
All data sent from node 2 is 157286400
All data received by node 2 is 157286400
All data sent from node 3 is 157286400
All data received by node 3 is 157286400
All data sent from node 4 is 157286400
All data received by node 4 is 157286400
All data sent from node 5 is 157286400
All data received by node 5 is 157286400
All data sent from node 6 is 157286400
All data received by node 6 is 157286400
All data sent from node 7 is 157286400
All data received by node 7 is 157286400
All data sent from node 8 is 157286400
All data received by node 8 is 157286400
All data sent from node 9 is 157286400
All data received by node 9 is 157286400
All data sent from node 10 is 157286400
All data received by node 10 is 157286400
All data sent from node 11 is 157286400
All data received by node 11 is 157286400
All data sent from node 12 is 157286400
All data received by node 12 is 157286400
All data sent from node 13 is 157286400
All data received by node 13 is 157286400
All data sent from node 14 is 157286400
All data received by node 14 is 157286400
All data sent from node 15 is 157286400
All data received by node 15 is 157286400
All data sent from node 16 is 157286400
All data received by node 16 is 157286400
All data sent from node 17 is 157286400
All data received by node 17 is 157286400
All data sent from node 18 is 157286400
All data received by node 18 is 157286400
All data sent from node 19 is 157286400
All data received by node 19 is 157286400
All data sent from node 20 is 157286400
All data received by node 20 is 157286400
All data sent from node 21 is 157286400
All data received by node 21 is 157286400
All data sent from node 22 is 157286400
All data received by node 22 is 157286400
All data sent from node 23 is 157286400
All data received by node 23 is 157286400
All data sent from node 24 is 157286400
All data received by node 24 is 157286400
All data sent from node 25 is 157286400
All data received by node 25 is 157286400
All data sent from node 26 is 157286400
All data received by node 26 is 157286400
All data sent from node 27 is 157286400
All data received by node 27 is 157286400
All data sent from node 28 is 157286400
All data received by node 28 is 157286400
All data sent from node 29 is 157286400
All data received by node 29 is 157286400
All data sent from node 30 is 157286400
All data received by node 30 is 157286400
All data sent from node 31 is 157286400
All data received by node 31 is 157286400
All data sent from node 32 is 157286400
All data received by node 32 is 157286400
All data sent from node 33 is 157286400
All data received by node 33 is 157286400
All data sent from node 34 is 157286400
All data received by node 34 is 157286400
All data sent from node 35 is 157286400
All data received by node 35 is 157286400
All data sent from node 36 is 157286400
All data received by node 36 is 157286400
All data sent from node 37 is 157286400
All data received by node 37 is 157286400
All data sent from node 38 is 157286400
All data received by node 38 is 157286400
All data sent from node 39 is 157286400
All data received by node 39 is 157286400
All data sent from node 40 is 157286400
All data received by node 40 is 157286400
All data sent from node 41 is 157286400
All data received by node 41 is 157286400
All data sent from node 42 is 157286400
All data received by node 42 is 157286400
All data sent from node 43 is 157286400
All data received by node 43 is 157286400
All data sent from node 44 is 157286400
All data received by node 44 is 157286400
All data sent from node 45 is 157286400
All data received by node 45 is 157286400
All data sent from node 46 is 157286400
All data received by node 46 is 157286400
All data sent from node 47 is 157286400
All data received by node 47 is 157286400
All data sent from node 48 is 157286400
All data received by node 48 is 157286400
All data sent from node 49 is 157286400
All data received by node 49 is 157286400
All data sent from node 50 is 157286400
All data received by node 50 is 157286400
All data sent from node 51 is 157286400
All data received by node 51 is 157286400
All data sent from node 52 is 157286400
All data received by node 52 is 157286400
All data sent from node 53 is 157286400
All data received by node 53 is 157286400
All data sent from node 54 is 157286400
All data received by node 54 is 157286400
All data sent from node 55 is 157286400
All data received by node 55 is 157286400
All data sent from node 56 is 157286400
All data received by node 56 is 157286400
All data sent from node 57 is 157286400
All data received by node 57 is 157286400
All data sent from node 58 is 157286400
All data received by node 58 is 157286400
All data sent from node 59 is 157286400
All data received by node 59 is 157286400
All data sent from node 60 is 157286400
All data received by node 60 is 157286400
All data sent from node 61 is 157286400
All data received by node 61 is 157286400
All data sent from node 62 is 157286400
All data received by node 62 is 157286400
All data sent from node 63 is 157286400
All data received by node 63 is 157286400
All data sent from node 64 is 157286400
All data received by node 64 is 157286400
All data sent from node 65 is 157286400
All data received by node 65 is 157286400
All data sent from node 66 is 157286400
All data received by node 66 is 157286400
All data sent from node 67 is 157286400
All data received by node 67 is 157286400
All data sent from node 68 is 157286400
All data received by node 68 is 157286400
All data sent from node 69 is 157286400
All data received by node 69 is 157286400
All data sent from node 70 is 157286400
All data received by node 70 is 157286400
All data sent from node 71 is 157286400
All data received by node 71 is 157286400
All data sent from node 72 is 157286400
All data received by node 72 is 157286400
All data sent from node 73 is 157286400
All data received by node 73 is 157286400
All data sent from node 74 is 157286400
All data received by node 74 is 157286400
All data sent from node 75 is 157286400
All data received by node 75 is 157286400
All data sent from node 76 is 157286400
All data received by node 76 is 157286400
All data sent from node 77 is 157286400
All data received by node 77 is 157286400
All data sent from node 78 is 157286400
All data received by node 78 is 157286400
All data sent from node 79 is 157286400
All data received by node 79 is 157286400
All data sent from node 80 is 157286400
All data received by node 80 is 157286400
All data sent from node 81 is 157286400
All data received by node 81 is 157286400
All data sent from node 82 is 157286400
All data received by node 82 is 157286400
All data sent from node 83 is 157286400
All data received by node 83 is 157286400
All data sent from node 84 is 157286400
All data received by node 84 is 157286400
All data sent from node 85 is 157286400
All data received by node 85 is 157286400
All data sent from node 86 is 157286400
All data received by node 86 is 157286400
All data sent from node 87 is 157286400
All data received by node 87 is 157286400
All data sent from node 88 is 157286400
All data received by node 88 is 157286400
All data sent from node 89 is 157286400
All data received by node 89 is 157286400
All data sent from node 90 is 157286400
All data received by node 90 is 157286400
All data sent from node 91 is 157286400
All data received by node 91 is 157286400
All data sent from node 92 is 157286400
All data received by node 92 is 157286400
All data sent from node 93 is 157286400
All data received by node 93 is 157286400
All data sent from node 94 is 157286400
All data received by node 94 is 157286400
All data sent from node 95 is 157286400
All data received by node 95 is 157286400
All data sent from node 96 is 157286400
All data received by node 96 is 157286400
All data sent from node 97 is 157286400
All data received by node 97 is 157286400
All data sent from node 98 is 157286400
All data received by node 98 is 157286400
All data sent from node 99 is 157286400
All data received by node 99 is 157286400
All data sent from node 100 is 157286400
All data received by node 100 is 157286400
All data sent from node 101 is 157286400
All data received by node 101 is 157286400
All data sent from node 102 is 157286400
All data received by node 102 is 157286400
All data sent from node 103 is 157286400
All data received by node 103 is 157286400
All data sent from node 104 is 157286400
All data received by node 104 is 157286400
All data sent from node 105 is 157286400
All data received by node 105 is 157286400
All data sent from node 106 is 157286400
All data received by node 106 is 157286400
All data sent from node 107 is 157286400
All data received by node 107 is 157286400
All data sent from node 108 is 157286400
All data received by node 108 is 157286400
All data sent from node 109 is 157286400
All data received by node 109 is 157286400
All data sent from node 110 is 157286400
All data received by node 110 is 157286400
All data sent from node 111 is 157286400
All data received by node 111 is 157286400
All data sent from node 112 is 157286400
All data received by node 112 is 157286400
All data sent from node 113 is 157286400
All data received by node 113 is 157286400
All data sent from node 114 is 157286400
All data received by node 114 is 157286400
All data sent from node 115 is 157286400
All data received by node 115 is 157286400
All data sent from node 116 is 157286400
All data received by node 116 is 157286400
All data sent from node 117 is 157286400
All data received by node 117 is 157286400
All data sent from node 118 is 157286400
All data received by node 118 is 157286400
All data sent from node 119 is 157286400
All data received by node 119 is 157286400
All data sent from node 120 is 157286400
All data received by node 120 is 157286400
All data sent from node 121 is 157286400
All data received by node 121 is 157286400
All data sent from node 122 is 157286400
All data received by node 122 is 157286400
All data sent from node 123 is 157286400
All data received by node 123 is 157286400
All data sent from node 124 is 157286400
All data received by node 124 is 157286400
All data sent from node 125 is 157286400
All data received by node 125 is 157286400
All data sent from node 126 is 157286400
All data received by node 126 is 157286400
All data sent from node 127 is 157286400
All data received by node 127 is 157286400

[SIMULATION COMPLETE] Printing routing statistics...
[ROUTING] Routing framework cleaned up.
[FLOWSIM] SimAI-FlowSim finished

real    0m11.031s
user    0m10.919s
sys     0m0.113s